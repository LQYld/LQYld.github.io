(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{364:function(t,a,s){t.exports=s.p+"assets/img/LifeCycle.f06e69e5.png"},499:function(t,a,s){"use strict";s.r(a);var n=s(42),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("解析")]),t._v(" "),n("ul",[n("li",[t._v("先执行 Nuxt 的生命周期。")]),t._v(" "),n("li",[t._v("再执行 Vue 的生命周期。 beforeCreated && created")]),t._v(" "),n("li",[t._v("最后执行其他的生命周期。")])])]),t._v(" "),n("br"),t._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:s(364)}})]),t._v(" "),n("h2",{attrs:{id:"nuxtserverinit-服务器初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nuxtserverinit-服务器初始化"}},[t._v("#")]),t._v(" nuxtServerInit （服务器初始化）")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("解析")]),t._v(" "),n("p",[t._v("nuxtServerInit 函数 会在服务器中运行，会的到 Vuex 的状态树，及服务端上下文信息。"),n("br"),t._v("\n服务端上下文信息 有 该项目的配置项信息，及请求、请求头等等信息。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nuxtServerInit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("store"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nuxtServerInit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("store"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("推荐")]),t._v(" "),n("p",[t._v("nuxtServerInit 函数的使用场景，一般利用于，服务器初始化绑定初始值。")])]),t._v(" "),n("h2",{attrs:{id:"middleware-中间件运行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#middleware-中间件运行"}},[t._v("#")]),t._v(" middleware （中间件运行）")]),t._v(" "),n("h3",{attrs:{id:"middleware-配置-在-nuxt-config-js-中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#middleware-配置-在-nuxt-config-js-中"}},[t._v("#")]),t._v(" middleware 配置 在 nuxt.config.js 中")]),t._v(" "),n("p",[t._v("我们要使用中间件运行时")]),t._v(" "),n("ul",[n("li",[n("ol",[n("li",[t._v("需要在 nuxt.config.js 文件中进行配置。")])])]),t._v(" "),n("li",[n("ol",{attrs:{start:"2"}},[n("li",[t._v("在 nuxt.config.js 文件中找到字段名为 router 的配置项。")])])]),t._v(" "),n("li",[n("ol",{attrs:{start:"3"}},[n("li",[t._v("在 router 中定义 middleware 字段名 设置中间件函数。 如例：例 middleware-1。")])])]),t._v(" "),n("li",[n("ol",{attrs:{start:"4"}},[n("li",[t._v("在目录结构中的 middleware 文件夹中 编写 中间件函数。 如例：例 middleware-2。")])])])]),t._v(" "),n("h4",{attrs:{id:"例-middleware-1。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#例-middleware-1。"}},[t._v("#")]),t._v(" 例 middleware-1。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  router"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    middleware"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auth"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"例-middleware-2。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#例-middleware-2。"}},[t._v("#")]),t._v(" 例 middleware-2。")]),t._v(" "),n("div",{staticClass:"language-cmd extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(" cd middleware\n mkdir auth.js\n")])])]),n("h4",{attrs:{id:"编写-auth-js-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写-auth-js-文件"}},[t._v("#")]),t._v(" 编写 auth.js 文件")]),t._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),n("p",[t._v("middleware 可以作为 项目路由的 全局守望。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// context 服务端上下 文信息")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("middleware"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("解析 （context）")]),t._v(" "),n("p",[t._v("context 服务端上下 文信息，可以获取到 store 状态树、路由、请求头、请求参数等一系列信息。"),n("br"),t._v("\ncontext 为对象格式。")])]),t._v(" "),n("h3",{attrs:{id:"middleware-定义在-layout-中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#middleware-定义在-layout-中"}},[t._v("#")]),t._v(" middleware 定义在 layout 中")]),t._v(" "),n("h4",{attrs:{id:"default-vue-文件中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#default-vue-文件中"}},[t._v("#")]),t._v(" default.vue 文件中")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  middleware"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auth"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("扩展")]),t._v(" "),n("p",[t._v("middleware 及可以定义为外部函数，也可以定义为内部函数。"),n("br"),t._v("\n如 例：middleware-3。")])]),t._v(" "),n("h4",{attrs:{id:"例-middleware-3。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#例-middleware-3。"}},[t._v("#")]),t._v(" 例 middleware-3。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("middleware")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"middleware"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"单页面中使用-middleware"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单页面中使用-middleware"}},[t._v("#")]),t._v(" 单页面中使用 middleware")]),t._v(" "),n("p",[t._v("与之前两种方式相同。在需要使用的页面中使用即可。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 外部方式引用")]),t._v("\n  middleware"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auth"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 内部函数方式")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("middleware")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"middleware"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"validate-校验参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#validate-校验参数"}},[t._v("#")]),t._v(" validate() 校验参数")]),t._v(" "),n("div",{staticClass:"custom-block danger"},[n("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),n("p",[t._v("validate() 用于判断是否允许进入该页面。"),n("br"),t._v("\nvalidate() 最好不要全局使用。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回 布尔值 表示是否允许进入该页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("validate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'validate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Boolean"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"asyncdata-fetch-异步函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#asyncdata-fetch-异步函数"}},[t._v("#")]),t._v(" asyncData & fetch 异步函数")]),t._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),n("p",[t._v("asyncData 与 fetch 执行没有先后顺序。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 页面中使用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("asyncData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("扩展（asyncData & fetch）的区别")]),t._v(" "),n("p",[t._v("asyncData 异步获取后，将数据注入页面中的 data 中。 返回的是对象。\nfetch 异步获取后，将数据注入项目中的 Vuex 状态树中。 并无返回，直接进行 store 操作。")])]),t._v(" "),n("h2",{attrs:{id:"关于-客户端生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于-客户端生命周期"}},[t._v("#")]),t._v(" 关于 客户端生命周期")]),t._v(" "),n("p",[t._v("客户端的生命周期与原生 Vue 的相同。")]),t._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),n("p",[t._v("服务端渲染 不支持 原有 Vue 中 keep-alive 组件。"),n("br"),t._v("\n所以不存在 activated() 及 deactivated()。")])]),t._v(" "),n("h2",{attrs:{id:"关于-window-对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于-window-对象"}},[t._v("#")]),t._v(" 关于 window 对象")]),t._v(" "),n("div",{staticClass:"custom-block danger"},[n("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),n("p",[t._v("在服务端的生命周期内，是获取不到 window 对象的。")])]),t._v(" "),n("h2",{attrs:{id:"不同生命周期内-this-的指向"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#不同生命周期内-this-的指向"}},[t._v("#")]),t._v(" 不同生命周期内 this 的指向")]),t._v(" "),n("h3",{attrs:{id:"服务端生命周期内"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务端生命周期内"}},[t._v("#")]),t._v(" 服务端生命周期内")]),t._v(" "),n("p",[t._v("this 的指向是 undefined。可以使用 服务端上下文 context。")]),t._v(" "),n("h3",{attrs:{id:"客户端生命周期内"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端生命周期内"}},[t._v("#")]),t._v(" 客户端生命周期内")]),t._v(" "),n("p",[t._v("this 的指向时 当前页面 或 当前组件本身，Vue。")])])}),[],!1,null,null,null);a.default=e.exports}}]);